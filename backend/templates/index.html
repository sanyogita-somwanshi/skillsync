<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SkillSync - Build the Skillset Recruiters Want</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .color-primary { background-color: #0d9488; } 
        .color-accent { background-color: #38bdf8; } 
        .text-primary { color: #0f766e; }
        .rounded-xl-lg { border-radius: 1.5rem; }
        .transition-ease { transition: all 0.3s ease-in-out; }
        .chatbot-button { position: fixed; bottom: 30px; right: 30px; z-index: 1000; cursor: pointer; }
        .chatbot-icon { box-shadow: 0 10px 15px -3px rgba(13, 148, 136, 0.5); }
        .chatbot-window { position: fixed; bottom: 30px; right: 30px; width: min(90vw, 380px); height: min(70vh, 550px); z-index: 1001; box-shadow: 0 20px 25px -5px rgba(0,0,0,0.2); display: none; flex-direction: column; }
        .user-message { background-color: #38bdf8; color: white; border-radius: 1rem 1rem 0.2rem 1rem; padding: 10px 14px; margin-bottom: 10px; align-self: flex-end; max-width: 80%; }
        .ai-message { background-color: #f0fdfa; border: 1px solid #0d9488; border-radius: 1rem 1rem 1rem 0.2rem; padding: 10px 14px; margin-bottom: 10px; align-self: flex-start; max-width: 80%; }
        .animate-pulse { animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: .5; } }
    </style>
</head>

<body class="font-sans text-gray-800 antialiased">

    <header class="sticky top-0 z-50 bg-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex justify-between items-center h-20">
            <a href="{{ url_for('home') }}" class="text-3xl font-bold text-teal-600 tracking-wider flex items-center space-x-2">
                <span>SkillSync</span>
            </a>
            <nav class="hidden md:flex space-x-10">
                <a href="{{ url_for('home') }}" class="text-gray-600 hover:text-teal-600 font-medium transition-ease">Home</a>
                <a href="#about-us" class="text-gray-600 hover:text-teal-600 font-medium transition-ease">About Us</a>
                <a href="{{ url_for('feedback') }}" class="text-gray-600 hover:text-teal-600 font-medium transition-ease">Student Feedback</a>
            </nav>
        </div>
    </header>

    <section class="bg-gray-50 py-16 md:py-20">
        <div class="max-w-6xl mx-auto px-4 text-center">
            <h1 class="text-5xl md:text-7xl font-extrabold text-gray-900 mb-6 leading-tight">
                <span class="text-teal-600">Stop Guessing.</span> Build the Skillset Recruiters Actually Want.
            </h1>
            <p class="text-xl md:text-2xl text-gray-600 mb-6 max-w-4xl mx-auto">
                SkillSync benchmarks your technical abilities against true industry demands and generates a personalized roadmap.
            </p>
            <a href="{{ url_for('register_page') }}" class="inline-block color-accent text-white font-bold text-xl py-4 px-12 rounded-xl-lg shadow-2xl hover:bg-sky-500 transition-ease">
                Start Your Assessment
            </a>
        </div>
    </section>

    <section class="py-20 bg-white" id="how-it-works">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <h2 class="text-4xl font-bold mb-12">How It Works</h2>
            <div class="grid md:grid-cols-3 gap-12">
                <div class="p-6 bg-gray-50 rounded-xl-lg border-t-4 border-teal-500 shadow-md">
                    <h3 class="text-xl font-bold mb-2">1. Define Goal</h3>
                    <p>Select your target role to see industry proficiency standards.</p>
                </div>
                <div class="p-6 bg-gray-50 rounded-xl-lg border-t-4 border-teal-500 shadow-md">
                    <h3 class="text-xl font-bold mb-2">2. Assess Skills</h3>
                    <p>Rate your proficiency to identify critical skill gaps.</p>
                </div>
                <div class="p-6 bg-gray-50 rounded-xl-lg border-t-4 border-teal-500 shadow-md">
                    <h3 class="text-xl font-bold mb-2">3. Execute Plan</h3>
                    <p>Follow a personalized roadmap to get hired.</p>
                </div>
            </div>
        </div>
    </section>

    <footer class="py-8 bg-gray-900 text-white text-center">
        <div class="max-w-7xl mx-auto px-4">&copy; 2025 SkillSync. All rights reserved.</div>
    </footer>

    <div id="chatbot-button" class="chatbot-button transition-ease hidden" onclick="toggleChatbot()">
        <div class="color-primary chatbot-icon rounded-full p-4 text-white hover:shadow-xl hover:scale-105 transition-ease flex items-center justify-center">
            <span class="text-3xl font-bold">ðŸ’¬</span>
        </div>
    </div>
    
    <div id="chatbot-window" class="chatbot-window bg-white rounded-xl-lg border-2 border-teal-500">
        <div class="p-4 color-primary text-white font-bold flex justify-between items-center rounded-t-xl-lg">
            <span>AI Career Guide</span>
            <button onclick="toggleChatbot()" class="text-xl font-light hover:text-gray-200">âœ•</button>
        </div>
        <div id="chat-messages" class="flex-grow p-4 overflow-y-auto flex flex-col bg-gray-50">
             <div class="ai-message">
                ðŸ‘‹ Hi! I'm your SkillSync Guide. Ask me about career paths or how to get started!
            </div>
        </div>
        <div class="p-3 border-t border-gray-200 flex bg-white rounded-b-xl-lg">
            <input type="text" id="chat-input" placeholder="Ask me anything..." class="flex-grow p-2 border border-gray-300 rounded-l-lg focus:outline-none focus:border-teal-500 text-sm">
            <button onclick="sendMessage()" id="send-button" class="bg-teal-600 text-white px-4 py-2 rounded-r-lg font-semibold hover:bg-teal-700 transition-ease text-sm">Send</button>
        </div>
    </div>

    <script>
        function toggleChatbot() {
            const w = document.getElementById('chatbot-window');
            w.style.display = (w.style.display === 'none' || w.style.display === '') ? 'flex' : 'none';
        }

        function appendMessage(sender, message) {
            const chatMessages = document.getElementById('chat-messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `flex w-full ${sender === 'user' ? 'justify-end' : 'justify-start'} mb-2`;
            messageDiv.innerHTML = `<div class="${sender === 'user' ? 'user-message' : 'ai-message'}">${message}</div>`;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function showLoading() {
            const chatMessages = document.getElementById('chat-messages');
            const loadingDiv = document.createElement('div');
            loadingDiv.id = 'loading-indicator';
            loadingDiv.className = 'flex justify-start mb-2';
            loadingDiv.innerHTML = `<div class="ai-message animate-pulse">Thinking...</div>`;
            chatMessages.appendChild(loadingDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            document.getElementById('send-button').disabled = true;
        }

        function hideLoading() {
            const loading = document.getElementById('loading-indicator');
            if (loading) loading.remove();
            document.getElementById('send-button').disabled = false;
        }

        async function sendMessage() {
            const input = document.getElementById('chat-input');
            const prompt = input.value.trim();
            if (!prompt) return;
            
            input.value = '';
            appendMessage('user', prompt);
            showLoading();

            try {
                // FIX: Sending to our Python Backend instead of Google directly
                const response = await fetch('/api/chat', { 
                    method: 'POST', 
                    headers: { 'Content-Type': 'application/json' }, 
                    body: JSON.stringify({ message: prompt }) 
                });
                
                const data = await response.json();
                const text = data.candidates?.[0]?.content?.parts?.[0]?.text || "I'm struggling to connect. Please try again.";
                
                hideLoading();
                appendMessage('ai', text);
            } catch (e) {
                hideLoading();
                appendMessage('ai', "Server error. Please check your internet connection.");
            }
        }
        
        document.getElementById('chat-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') sendMessage();
        });

        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('chatbot-button').classList.remove('hidden'); 
        });
    </script>
</body>
</html>